name: Tests

on: [push, pull_request]

jobs:
  run-tests:
    runs-on: ubuntu-latest
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
      
    - name: Install Packages 
      run: pip install pyyaml coverage
      
    - name: Run tests
      run: python -m coverage run -m unittest discover -s tests
       
    - name: Test and Coverage
      run: python -m coverage json
     # Add this
    - name: Update Coverage Badge
      # GitHub actions: default branch variable
      # https://stackoverflow.com/questions/64781462/github-actions-default-branch-variable
      if: github.ref == format('refs/heads/{0}', github.event.repository.default_branch)
      uses: we-cli/coverage-badge-action@main
